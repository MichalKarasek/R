{
    "collab_server" : "",
    "contents" : "Helmert_transformation<-function(filepath){\noptions(digits=10)\ncor = read.table(file = filepath, header=TRUE, sep=\" \", dec = \".\")\n\nrz=ncol(cor);\nfor (i in 1:rz){\nif(cor[1,i]==\"stop\"){\nk=i-2}\n}\nb1Y=matrix(nrow=1,ncol=k/2);\nb1X=matrix(nrow=1,ncol=k/2);\nb1y=matrix(nrow=1,ncol=k/2);\nb1x=matrix(nrow=1,ncol=k/2);\n\n\nfor(i in 1:k/2){\nb1Y[i]=cor[1,i+1]\nb1X[i]=cor[1,(k/2+i+1)]\nb1y[i]=cor[1,(k+2+i)]\nb1x[i]=cor[1,(3*k/2+2+i)]\n}\nYt=mean(b1Y)\nXt=mean(b1X)\nyt=mean(b1y)\nxt=mean(b1x)\n\nyri=matrix(nrow=1,ncol=k/2);\nxri=matrix(nrow=1,ncol=k/2);\nYri=matrix(nrow=1,ncol=k/2);\nXri=matrix(nrow=1,ncol=k/2);\n\n\nfor(i in 1:k/2){\nyri[i]=b1y[i]-yt;\nxri[i]=b1x[i]-xt;\nYri[i]=b1Y[i]-Yt;\nXri[i]=b1X[i]-Xt;\n}\n\n#melo by se blizit nule\nsyri=sum(yri);\nsxri=sum(xri);\nsYri=sum(Yri);\nsYri=sum(Xri);\n\nsyY=sum(yri*Yri);\nsxX=sum(xri*Xri);\nsxY=sum(xri*Yri);\nsyX=sum(yri*Xri);\n\n\nrx=matrix(nrow=1,ncol=k/2);\nry=matrix(nrow=1,ncol=k/2);\nr=matrix(nrow=1,ncol=k/2);\n\nfor(i in 1:(k/2)){\nrx[i]=xri[i]*xri[i];\nry[i]=yri[i]*yri[i];\nr[i]=xri[i]*xri[i]+yri[i]*yri[i];\n}\n\nsx2y2=sum(xri*xri+yri*yri);\nsr=sum(r);\n#kontrola sx2y2-sum(r) is zero\n\nlam1=(sxX+syY)/sx2y2;\nlam2=(sxY-syX)/sx2y2;\nq=sqrt(lam1*lam1+lam2*lam2);\nom_rad=atan2(lam2,lam1);\n\nif(om_rad<0){\nom_rad=(om_rad+2*pi);\n}\n\nom_gon=om_rad*200/pi;\n\nYp=Yt-lam1*yt-lam2*xt\nXp=Xt-lam1*xt+lam2*yt\n\nY_id=matrix(nrow=1,ncol=k/2);\nX_id=matrix(nrow=1,ncol=k/2);\n\n\nfor(i in 1:k/2){\nY_id[i]=Yp+lam1*b1y[i]+lam2*b1x[i];\nX_id[i]=Xp+lam1*b1x[i]-lam2*b1y[i];\n}\n\n#POSUNY V MILIMETRECH!!!!\n\nvy=(Y_id-b1Y)*1000;\nvx=(X_id-b1X)*1000;\n\nsvy=sum(vy);\nsvx=sum(vx);\n\nvv=vy*vy+vx*vx;\nsvv=sum(vv);\nrow=sqrt(vv);\n\n#mira identity\n\ns_v=sqrt(sum(row*row)/(k/2));\n\n#stredni rozdil souradnicovych chyb\ns_o=sqrt(sum(row*row)/(2*(k/2)-4));\n\n#pro minimalni pocet (4) bodu je s_v=s_o\n\n#stredni rozdil v poloze danych bodu\ns_p=s_o*sqrt(2);\n\n#stredni chyby (smer. odchylky) neznamych, s_x=s_y, proto s_y nikde neuvadim!\n\ns_x=matrix(nrow=1,ncol=k/2);\nfor(i in 1:(k/2)){\ns_x[i]=sqrt((s_o/1000)^2*(1/(k/2)+r[i]/sr))\n}\t\t#ACHTUNG v Metrech!!!!\n\ns_x_mm=s_x*1000;\n\n#stredni rozdil v poloze transformacniho bodu\nsd=sqrt(s_x^2+s_x^2);\nsd_mm=sd*1000;\n\n#PODROBNE BODY\n\nj=rz-2*k-3;\nb2y=matrix(nrow=1,ncol=j/2);\nb2x=matrix(nrow=1,ncol=j/2);\n\nfor(i in 1:j/2){\nb2y[i]=cor[1,(2*k+i+3)]\nb2x[i]=cor[1,(j/2+2*k+i+2)]\n}\n\nY_p=matrix(nrow=1,ncol=j/2);\nX_p=matrix(nrow=1,ncol=j/2);\n\n\nfor(i in 1:j/2){\nY_p[i]=Yp+lam1*b2y[i]+lam2*b2x[i];\nX_p[i]=Xp+lam1*b2x[i]-lam2*b2y[i];\n}\n\n\nidentic <- data.frame(\n      Transformation_points = (\"identical point\"),\n      original_Y = round(c(b1Y), digits = 3),\n      original_X = round(c(b1X), digits = 3),\n \toriginal_y = round(c(b1y), digits = 3),\n      original_x = round(c(b1x), digits = 3),\n\tshift_vy_mm = round(c(vy), digits = 1),\n      shift_vx_mm = round(c(vx), digits = 1),\n\trho_mm = round(c(row), digits = 1),\n\tstandard_deviation_mm = round(c(sd_mm), digits = 1),\n\t stringsAsFactors = TRUE )\n\n\n\npodrob <- data.frame(\n      Determined_points = c(\"measured point\"),\n          new_Y = round(c(b2y),digits = 3),\n          new_X = round(c(b2y), digits = 3),\n\toriginal_y = round(c(Y_p), digits = 3),\n\toriginal_x = round(c(X_p), digits = 3),\n      stringsAsFactors = FALSE\n    )\n\ninfos <- data.frame(\nkey_lambda1 = round(c(lam1),digits = 3),\nkey_lambda2 = round(c(lam2), digits = 3),\n\tratio = round(c(q), digits = 8),\n\tomega_gon = round(c(om_gon), digits = 4),\nrate_of_identity_mm = round(c(s_v), digits = 2),\nmean_absolute_difference_of_coordinate_deviation_mm = round(c(s_p), digits = 3),\nstringsAsFactors = FALSE)\n\n\n\nwrite.csv(identic,file= \"Output_Helmert_transformation.csv\", row.names = FALSE, sep = \"\\t\",\n append = TRUE)\nwrite.table(podrob,file= \"Output_Helmert_transformation.csv\", row.names = FALSE, sep = \"\\t\",\ncol.names = TRUE,\n append = TRUE)\n\nwrite.table(infos,file= \"Output_Helmert_transformation.csv\", row.names = FALSE, sep = \"\\t\",\ncol.names = TRUE,\n append = TRUE)\n\n}\n\n",
    "created" : 1496675045376.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2194853359",
    "id" : "95A77B6F",
    "lastKnownWriteTime" : 1496675788,
    "last_content_update" : 1496675788,
    "path" : "~/GEOMASS/R/Helmert_transformation.R",
    "project_path" : "R/Helmert_transformation.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}